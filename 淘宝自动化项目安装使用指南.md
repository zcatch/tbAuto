# 淘宝自动化项目安装使用指南

## 📋 项目概述

这是一个基于 **uiautomator2** 的淘宝自动化任务项目，主要功能包括：
- 淘宝双11金币任务自动化
- 淘金币任务
- 芭芭农场任务  
- 闲鱼任务
- 支付宝农场任务

## 🔧 环境要求

### 系统要求
- **操作系统**: Windows 10/11
- **Python版本**: Python 3.12+
- **Android设备**: 支持USB调试的Android手机

### 必需软件
1. **Python 3.12+** - 编程语言环境
2. **ADB (Android Debug Bridge)** - Android设备调试工具
3. **Tesseract OCR** - 文字识别工具（可选）

## 📦 安装步骤

### 步骤1：安装Python依赖包

项目已包含 `requirements.txt` 文件，安装所有依赖：

```bash
py -m pip install -r requirements.txt
```

**包含的依赖包：**
- uiautodev==0.12.0
- uiautomator2==3.3.4
- pytesseract==0.3.13
- opencv-python==4.11.0.86
- ddddocr==1.5.6

### 步骤2：安装ADB工具

**方法1：下载Android Platform Tools**
1. 访问：https://developer.android.com/studio/releases/platform-tools
2. 下载 Windows 版本
3. 解压到 `C:\adb\` 或您喜欢的目录
4. 将 `C:\adb\` 添加到系统 PATH 环境变量

**方法2：通过Android Studio安装**
1. 下载并安装 Android Studio
2. ADB会自动包含在安装中

**验证安装：**
```bash
adb version
```

### 步骤3：安装Tesseract OCR（可选）

1. 访问：https://github.com/UB-Mannheim/tesseract/wiki
2. 下载 Windows 安装包
3. 安装后配置环境变量：
   - 默认路径：`C:\Program Files\Tesseract-OCR\`
   - 添加到 PATH 环境变量

**验证安装：**
```bash
tesseract --version
```

## 📱 Android设备配置

### 开启开发者选项
1. 进入 **设置** → **关于手机**
2. 连续点击 **版本号** 7次
3. 返回设置，找到 **开发者选项**

### 开启USB调试
1. 进入 **开发者选项**
2. 开启 **USB调试**
3. 开启 **USB安装**（如果有）
4. 开启 **USB调试（安全设置）**（如果有）

### 连接设备
1. 通过USB线连接手机到电脑
2. 选择 **文件传输** 或 **MTP模式**
3. 手机弹出授权对话框时：
   - 勾选 **"始终允许来自此计算机"**
   - 点击 **"确定"**

### 验证连接
```bash
adb devices
```
应该显示类似：
```
List of devices attached
4c21fb81    device
```

## 🚀 使用方法

### 方法1：使用批处理文件（推荐）

项目已创建了完整的批处理文件集合：

#### 主菜单
- **run_all_tasks.bat** - 主菜单，选择要运行的任务

#### 单个任务批处理文件
- **run_taobao_signin.bat** - 淘宝签到任务
- **run_taobao_coin.bat** - 淘金币任务  
- **run_taobao_farm.bat** - 淘宝芭芭农场任务
- **run_taobao_2024.bat** - 2024淘宝双11任务
- **run_taobao_2025.bat** - 2025淘宝双11任务
- **run_taobao_618.bat** - 淘宝618活动任务
- **run_xianyu.bat** - 闲鱼任务
- **run_alipay_farm.bat** - 支付宝农场任务

#### 工具批处理文件
- **fix_device_connection.bat** - 设备连接修复工具
- **check_device.bat** - 设备连接检查工具

### 方法2：使用IDE运行

1. 打开VS Code或PyCharm
2. 打开项目文件夹：`D:\phpstudy_pro\WWW\coin11-tb`
3. 右键点击Python文件 → 运行

### 方法3：命令行运行

```bash
# 进入项目目录
cd D:\phpstudy_pro\WWW\coin11-tb

# 运行Python脚本
py 淘宝签到任务.py
py 淘金币任务.py
py 2025淘宝双11.py
```

## ⚠️ 常见问题及解决方案

### 问题1：设备连接失败
**错误信息：** `Can't find any android device/emulator`

**解决方案：**
1. 检查USB连接
2. 确认USB调试已开启
3. 重新授权设备
4. 运行 `fix_device_connection.bat` 修复连接

### 问题2：uiautomator2服务启动失败
**错误信息：** `LaunchUiAutomationError: server quit unexpectly`

**解决方案：**
```bash
py -m uiautomator2 init
```

### 问题3：文件名编码问题
**错误信息：** `can't open file` 或编码错误

**解决方案：**
1. 使用批处理文件运行
2. 在IDE中运行Python文件
3. 重命名文件为英文名称

### 问题4：IME键盘安装失败
**错误信息：** `install AdbKeyboard ime failed`

**解决方案：**
这是可选功能，不影响主要自动化功能，可以忽略。

## 📱 运行前检查清单

### 设备要求：
- [ ] Android设备已连接USB
- [ ] 已开启USB调试
- [ ] 已授权调试权限
- [ ] 设备显示为 `device` 状态

### 应用要求：
- [ ] 已安装淘宝APP
- [ ] 已安装闲鱼APP（运行闲鱼任务时需要）
- [ ] 已安装支付宝APP（运行支付宝农场任务时需要）

### 运行环境：
- [ ] 手机保持亮屏状态
- [ ] 不要锁屏或切换应用
- [ ] 网络连接正常

## 🎯 推荐使用流程

### 首次使用：
1. **检查设备连接**：运行 `fix_device_connection.bat`
2. **测试简单任务**：运行 `run_taobao_signin.bat`
3. **观察运行过程**：确认一切正常
4. **运行其他任务**：使用 `run_all_tasks.bat` 主菜单

### 日常使用：
1. **连接设备**：确保手机已连接并授权
2. **选择任务**：双击 `run_all_tasks.bat` 选择要运行的任务
3. **监控运行**：观察脚本运行过程
4. **完成任务**：等待脚本自动完成

## 📊 项目文件说明

### Python脚本文件：
- `2024淘宝双11.py` - 2024年淘宝双11任务
- `2025淘宝双11.py` - 2025年淘宝双11任务
- `淘宝签到任务.py` - 淘宝签到任务
- `淘宝芭芭农场.py` - 芭芭农场任务
- `淘金币任务.py` - 淘金币任务
- `闲鱼任务.py` - 闲鱼任务
- `支付宝农场.py` - 支付宝农场任务
- `淘宝618活动.py` - 淘宝618活动
- `utils.py` - 工具函数库

### 批处理文件：
- `run_all_tasks.bat` - 主菜单
- `run_taobao_*.bat` - 各种任务批处理文件
- `fix_device_connection.bat` - 设备连接修复
- `check_device.bat` - 设备连接检查

### 配置文件：
- `requirements.txt` - Python依赖包列表
- `README.md` - 项目说明文档

## 🔧 故障排除

### 设备连接问题：
1. 重启ADB服务：`adb kill-server && adb start-server`
2. 重新连接USB线
3. 检查USB驱动
4. 尝试不同的USB端口

### 脚本运行问题：
1. 检查设备连接状态
2. 确认相关APP已安装
3. 检查网络连接
4. 查看错误日志

### 性能优化：
1. 关闭不必要的应用
2. 保持手机充电状态
3. 使用稳定的网络连接
4. 定期清理手机缓存

## 📞 技术支持

如果遇到问题，请按以下顺序排查：
1. 检查设备连接状态
2. 查看错误日志信息
3. 重启ADB服务
4. 重新连接设备
5. 检查Python环境

## 🔄 依赖包更新

### 更新依赖包的方法

当 `requirements.txt` 文件更新后，需要更新已安装的依赖包：

#### 方法1：使用 `--upgrade` 参数（推荐）
```bash
py -m pip install -r requirements.txt --upgrade
```

#### 方法2：强制重新安装
```bash
py -m pip install -r requirements.txt --force-reinstall
```

#### 方法3：先卸载再安装
```bash
py -m pip uninstall uiautodev
py -m pip install -r requirements.txt
```

### 验证更新结果
```bash
# 检查uiautodev版本
py -c "import uiautodev; print('uiautodev版本:', uiautodev.__version__)"

# 检查所有已安装包
py -m pip list | findstr uiautomator2
```

### 最新更新记录

#### 2025-10-21 更新
- **uiautodev**: 0.9.0 → **0.12.0** ✅
- **uiautomator2**: 3.3.4 (保持不变)
- **pytesseract**: 0.3.13 (保持不变)
- **opencv-python**: 4.11.0.86 (保持不变)
- **ddddocr**: 1.5.6 (保持不变)

**更新内容：**
- uiautodev 升级到 0.12.0 版本
- 包含性能优化和新功能
- 更好的兼容性和稳定性
- 其他依赖包保持稳定版本

## 📝 更新日志

- **v1.0** - 初始版本，支持基本自动化任务
- **v1.1** - 添加批处理文件支持
- **v1.2** - 优化设备连接稳定性
- **v1.3** - 添加错误处理和日志记录
- **v1.4** - 更新uiautodev到0.12.0版本

---

**注意：** 请确保遵守相关平台的使用条款，合理使用自动化工具。
